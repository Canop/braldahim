<ul class="box_contenu1 textalic">
	<ul class="titre textalic textsizea">
	Scripts Publics pour développeurs
	</ul>
	<br>
	Les données publiques et les Scripts Publics permettent à tout développeur de pouvoir
	construire une interface de jeu externe.<br>
	
	<br><br>
	
	<table width="100%">
		<tr valign="top">
			<td  width="50%">
				<ul class="titre textalic textsizeb">
				Données Publiques
				</ul>
				<br>
				<ul style="text-align:left">
					<li>
					Fichiers CSV disponibles à l'adresse : <a href='http://public.braldahim.com'>http://public.braldahim.com</a>
					</li>
					<li>
					Les fichiers sont encodés en UTF8
					</li>
				</ul>
				<br><br>
			
			</td>
			<td style="border-left: 1px solid #791E1E; align:left" width="50%">
				<ul class="titre textalic textsizeb">
				Scripts Publics
				</ul>
				<br>
				<ul style="text-align:left">
					<li>
					Les Scripts Publics renvoient les données associées à un Hobbit.
					</li>
					<li>
					Le nombre d'appels autorisés aux Scripts Publics est limité. 
					</li>
					<li>
					 XXX = le NUMERO d'un Hobbit
					</li>
					<li>
					 YYY = le mot de passe restreint correspondant. 
					</li>
					<li>
					Le mot de passe restreint peut-être obtenu ici : <a href='/md5/'>http://sp.braldahim.com/md5/</a>. 
					</li>
				</ul>
				<br>
				
				<br>
			</td>
		</tr>
	</table>
</ul>

<br>

<ul class="box_contenu1 textalic">
	<ul class="titre textalic textsizeb">
	Détails des Scripts Publics
	</ul>
	<br>
	
	Le nombre d'appels autorisés aux Scripts Publics est limité par <u>jour et par catégorie</u>.<br>
	<br>
	<table style="width:90%" class="table_liste">
		
		<thead class="table_liste">
			<th colspan="2">Catégorie Scripts Dynamiques : 24 appels par jour</th>
		</thead>
		
		<tr valign="top">
			<td width="20%">
				Vue
			</td>
			<td width="80%" style="text-align:left">
			Version : 1<br>
			URL : http://sp.braldahim.com/scripts/vue/?idHobbit=XXX&mdpRestreint=YYYY&version=1<br>
			Détails d'une ligne: TYPE;position_x;position_y;postion_z;autre_element;autre_element...
			
			<div id='details_vue_a' style="display:block" >
			  	<input type='button' class='button1' value='Afficher détails' onClick="javascript:switch2div('details_vue_a','details_vue_b');">
			</div>
				
			<div id='details_vue_b' style="display:none" >
			<input type='button' class='button1' value='Cacher détails' onClick="javascript:switch2div('details_vue_a', 'details_vue_b');">
			
			<pre style="background-color:#CCCC99; text-align:left" >
			ENVIRONNEMENT;x;y;z;nom_systeme_environnement;nom_environnement;vueNbCases
			CADAVRE;x;y;z; id_monstre;nom_type_monstre;$c_taille
			CHARRETTE;x;y;z; id_charrette;nom_type_materiel
			ECHOPPE;x;y;z;id_echoppe;nom_echoppe;nom_systeme_metier;nom_metier;id_hobbit
			CHAMP;x;y;z;id_champ;id_hobbit
			CREVASSE;x;y;z;id_crevasse
			ELEMENT;x;y;z;Peau;quantite_peau_element
			ELEMENT;x;y;z;Cuir;quantite_cuir_element 
			ELEMENT;x;y;z;Fourrure;quantite_fourrure_element
			ELEMENT;x;y;z;Planche;quantite_planche_element
			ELEMENT;x;y;z;Rondin;quantite_rondin_element
			ELEMENT;x;y;z;Castar;quantite_castar_element
			EQUIPEMENT;x;y;z;id_element_equipement;nom;nom_type_qualite;niveau_recette_equipement;suffixe_mot_runique
			MATERIEL;x;y;z;id_element_materiel;nom_type_materiel
			MUNITION;x;y;z;nom_type_munition;nom_pluriel_type_munition;quantite_element_munition
			POTION;x;y;z;id_element_potion;type;nom_type_potion;nom_type_qualite;niveau_potion
			ALIMENT;x;y;z;id_element_aliment;nom_type_aliment;nom_type_qualite
			GRAINE;x;y;z;quantite_element_graine;nom_type_graine
			INGREDIENT;x;y;z;quantite_element_ingredient;nom_type_ingredient
			MINERAI_BRUT;x;y;z;quantite_brut_element_minerai;nom_type_minerai
			LINGOT;x;y;z;quantite_lingots_element_minerai;nom_type_minerai
			PLANTE_BRUTE;x;y;z;quantite_element_partieplante;nom_type_partieplante;nom_type_plante
			PLANTE_PREPAREE;x;y;z;quantite_preparee_element_partieplante;nom_type_partieplante;nom_type_plante
			RUNE;x;y;z;id_rune_element_rune
			TABAC;x;y;z;quantite_feuille_element_tabac;nom_court_type_tabac
			HOBBIT;x;y;z;id_hobbit
			LIEU;x;y;z;id_lieu;nom_lieu;nom_type_lieu;nom_systeme_type_lieu
			MONSTRE;x;y;z;id_monstre;nom_type_monstre;m_taille;niveau_monstre
			NID;x;y;z;id_nid;nom_nid_type_monstre
			PALISSADE;x;y;z;id_palissade;est_destructible_palissade
			BUISSON;x;y;z;id_buisson;nom_type_buisson
			BOSQUET;x;y;z;id_bosquet;nom_systeme_type_bosquet
			BALISE;x;y;z;id_route
			BALLON_SOULE;x;y;z;present
			</pre>
			<input type='button' class='button1' value='Cacher détails' onClick="javascript:switch2div('details_vue_a', 'details_vue_b');">
			</div>
			</td>
		</tr>
		<tr valign="top">
			<td  width="20%">
				<br>Profil
			</td>
			<td width="80%" style="text-align:left">
			Version : 1<br>
			URL : http://sp.braldahim.com/scripts/profil/?idHobbit=XXX&mdpRestreint=YYYY&version=1<br>
			Détails d'une ligne: 
			
			
			<div id='details_profil_a' style="display:block" >
			  	<input type='button' class='button1' value='Afficher détails' onClick="javascript:switch2div('details_profil_a','details_profil_b');">
			</div>
				
			<div id='details_profil_b' style="display:none" >
			<input type='button' class='button1' value='Cacher détails' onClick="javascript:switch2div('details_profil_a', 'details_profil_b');">
			
			<pre style="background-color:#CCCC99; text-align:left" >
			Toutes les valeurs retournées sont sur une même ligne :
			
			idHobbit;prenom;nom;x;y;z;paRestant;DLA;DureeProchainTour;PvRestant;bmPVmax;bbdf;
			nivAgilite;nivForce;nivVigueur;nivSagesse;
			bmAgilite;bmForce;bmVigueur;bmSagesse;
			bmBddfAgilite;bmBddfForce;bmBddfVigueur;bmBddfSagesse;
			bmVue;regeneration;bmRegeneration;
			pxPerso;pxCommun;pi;niveau;poidsTransportable;poidsTransporte;armureNaturelle;
			armureEquipement;bmAttaque;bmDegat;bmDefense;nbKo;nbKill;nbKoHobbit;
			estEngage;estEngageProchainTour;estIntangible;nbPlaquagesSubis;nbPlaquagesEffectues
			</pre>
			<input type='button' class='button1' value='Cacher détails' onClick="javascript:switch2div('details_profil_a', 'details_profil_b');">
			</div>
			</td>
		</tr>
		<tr valign="top">
			<td  width="20%">
				<br>Événements
			</td>
			<td width="80%" style="text-align:left">
			Version : 1<br>
			URL : http://sp.braldahim.com/scripts/evenements/?idHobbit=XXX&mdpRestreint=YYYY&version=1<br>
			Détails d'une ligne: idHobbit;idEvenement;type;date;details
			<br><br>
			</td>
		</tr>
		
		<thead class="table_liste">
			<th colspan="2">Catégorie Scripts Statiques : 10 appels par jour</th>
		</thead>
		<tr valign="top">
			<td  width="20%">
				<br>Compétences
			</td>
			<td width="80%" style="text-align:left">
			Version : 1<br>
			URL : http://sp.braldahim.com/scripts/competences/?idHobbit=XXX&mdpRestreint=YYYY&version=1<br>
			Détails d'une ligne: idCompetence;nom;nom_systeme;maitrise;idMetier
			<br><br>
			</td>
		</tr>
		<tr valign="top">
			<td  width="20%">
				<br>Contenu du Laban
			</td>
			<td width="80%" style="text-align:left">
			A venir.
			</td>
		</tr>
		<tr valign="top">
			<td  width="20%">
				<br>Contenu de la charrette
			</td>
			<td width="80%" style="text-align:left">
			A venir.
			</td>
		</tr>
		<tr valign="top">
			<td  width="20%">
				<br>Contenu du coffre
			</td>
			<td width="80%" style="text-align:left">
			A venir.
			</td>
		</tr>
		<tr valign="top">
			<td  width="20%">
				<br>Liste des échoppes
			</td>
			<td width="80%" style="text-align:left">
			A venir.
			</td>
		</tr>
		<tr valign="top">
			<td  width="20%">
				<br>Liste des champs
			</td>
			<td width="80%" style="text-align:left">
			A venir.
			<br><br><br>
			</td>
		</tr>
		
		<thead class="table_liste">
			<th colspan="2">Catégorie Scripts Appels : 6 appels par jour</th>
		</thead>
		<tr valign="top">
			<td  width="20%">
				<br>Appels
			</td>
			<td width="80%" style="text-align:left">
			A venir.
			</td>
		</tr>
	</table>
	<br><br>
	
	<table style="width:90%" class="table_liste">
		
		<thead class="table_liste">
			<th colspan="2">Elements Communs</th>
		</thead>
		<tr>
			<td>
			La première ligne renvoyée indique soit une erreur, soit le nombre d'appels en cours.
			<br><br>
			
			Exemple nominal : 
			<pre style="background-color:#CCCC99; text-align:left" >
			TYPE:dynamique;NB_APPELS:15;MAX_AUTORISE:24
			[..] (la suite des résultats sur les lignes suivantes)
			</pre>
			
			Exemple avec le code ERREUR-09 : 
			<pre style="background-color:#CCCC99; text-align:left">
			ERREUR-09. Depassement Appels;TYPE:dynamique;NB_APPELS:26;MAX_AUTORISE:24 
			</pre>
			
			Exemple avec un autre code erreur : 
			<pre style="background-color:#CCCC99; text-align:left">
			ERREUR-03. Hobbit inconnu
			</pre>
			
			</td>
		</tr>
	</table>
	
	<br><br>
	<table style="width:90%" class="table_liste">
		
		<thead class="table_liste">
			<th colspan="2">Code d'erreurs</th>
		</thead>
		<tr>
			<td>
			ERREUR-01. Erreur Technique, l'équipe est informée
			</td>
		</tr>
		<tr>
			<td>
			ERREUR-02. Paramètres incorrects
			</td>
		</tr>
		<tr>
			<td>
			ERREUR-03. Hobbit inconnu
			</td>
		</tr>
		<tr>
			<td>
			ERREUR-04. Mot de passe invalide
			</td>
		</tr>
		<tr>
			<td>
			ERREUR-05. Hobbit désactivé ou pnj
			</td>
		</tr>
		<tr>
			<td>
			ERREUR-06. Service temporairement désactivé
			</td>
		</tr>
		<tr>
			<td>
			ERREUR-07. Service inconnu
			</td>
		</tr>
		<tr>
			<td>
			ERREUR-08. Version incorrecte
			</td>
		</tr>
		<tr>
			<td>
			ERREUR-09. Dépassement appels
			</td>
		</tr>
	</table>
	<br>
</ul>

<br>

<ul class="box_contenu1 textalia">
	<ul class="titre textalic textsizeb">
	Aide
	</ul>
		<br>
	<ul class="titre textalic textsized">
		Débuter
	</ul>
	<ul class="textalic">
 	Débuter en php : <a href='http://www.phpdebutant.org/'>http://www.phpdebutant.org/</a>, <a href='http://php.developpez.com/cours/'>http://php.developpez.com/cours/</a><br>
 	Pour les plus aguérris : <a href='http://www.z-f.fr/page/comment_debuter'>http://www.z-f.fr/page/comment_debuter</a>, <a href='http://g-rossolini.developpez.com/tutoriels/php/zend-framework/debuter/'>Article Zend Framework</a>
 	</ul>
 	
 	<br><br>
 	
 	<ul class="titre textalic textsized">
		Premier Exemple
	</ul>
	
	<pre style="background-color:#CCCC99">
			
			/* lecture du fichier et stockage dans la chaîne de caractères "$buffer" */
			$fichier = "http://public.braldahim.com/hobbits.csv";
			$buffer = "";
			$fd = @fopen($fichier,"r");
			if ($fd) {
				while (!@feof($fd)) { $buffer .= @fgets($fd, 4096); }
				@fclose ($fd);
			
				/* premier découpage en tranches : les lignes sont séparées */
				$lignes = explode("\n", $buffer );
					
				/* chaque ligne est à nouveau découpée en tranches, par champs, et affichée */
				$i=0;
				while ($lignes[$i]) {
					$data = explode(";", $lignes[$i]);
					echo $data[0]." - ".$data[1]." - ". $data[2]." - ". $data[3]." - ". $data[4]." - ". $data[5]." - ". $data[6]."&lt;br&gt;";
					$i++;
				}
			} else { 
				echo "Le fichier "".$fichier."" est inaccessible : "; 
			}
		</pre>

			<ul class="titre textalic textsized">
				Exemple optimisé
			</ul>
			
			Remplacer :
			<pre style="background-color:#CCCC99">
			while (!@feof($fd)){ $buffer .= @fgets($fd, 4096); }
			@fclose ($fd);
			$lignes = explode("\n", $buffer );
			</pre>
			par :
			<pre style="background-color:#CCCC99">
			while (!@feof($fd)){ $lignes[] = @fgets($fd, 4096); }
			@fclose ($fd);
			</pre>
			<br>
			Remplacer :
			<pre style="background-color:#CCCC99">
			echo $data[0]." - ".$data[1]." - ". $data[2]." - ". $data[3]." - ". $data[4]." - ". $data[5]." - ". $data[6]."&lt;br&gt;";
			</pre>
			par :
			<pre style="background-color:#CCCC99">
			echo implode(" - ", $data );
			</pre>

			</pre>
	</ul>
	<br>
</ul>

<br>

<ul class="box_contenu1 textalic">
	<p align="center"><a href="http://www.jeuxweb.org" target="_blank" class="AllLinks">Braldahim est un jeu géré par l'association sans but lucratif JeuxWeb.org </a><br>
		<a href="http://www.jeuxweb.org" target="_blank"><img src="http://www.mountyhall.com/images/Banner/banner_jw.gif" alt="JeuxWeb" border="0" height="60" width="468"></a>
	</p>
</ul>